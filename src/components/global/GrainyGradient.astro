---
/* GrainyGradient.astro
   Genera los blobs de color animados con textura de ruido
   basados en la identidad visual de Vantta.
*/
const { class: className } = Astro.props;
---

<div class:list={["grainy-container", className]}>
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
    <div class="blob blob-3"></div>
    
    <svg class="hidden">
        <filter id="noiseFilter">
            <feTurbulence 
                type="fractalNoise" 
                baseFrequency="0.65" 
                numOctaves="3" 
                stitchTiles="stitch" />
            <feColorMatrix type="saturate" values="0" />
        </filter>
    </svg>
</div>

<style>
    .grainy-container {
        position: absolute;
        inset: 0;
        overflow: hidden;
        background-color: #131313; /* Tu color 'black' de la config */
        z-index: -1;
        /* Performance: create a new stacking context */
        transform: translate3d(0, 0, 0);
    }

    /* La capa de ruido: escalada para que no se vean patrones repetitivos */
    .grainy-container::before {
        content: "";
        position: absolute;
        inset: -100%;
        width: 300%;
        height: 300%;
        opacity: 0.12;
        pointer-events: none;
        filter: url(#noiseFilter);
        mix-blend-mode: overlay; /* Mejor integraci√≥n con los colores */
        /* Disable noise on mobile for performance if needed, or keep it static */
    }

    .blob {
        position: absolute;
        border-radius: 50%;
        filter: blur(80px); /* Reduced blur for performance */
        opacity: 0.3;
        will-change: transform;
        transform: translateZ(0); /* Forzar GPU */
    }

    /* Animations only on desktop/fine pointer */
    @media (min-width: 768px) {
        .blob {
            animation: float 20s infinite alternate ease-in-out;
            filter: blur(100px);
        }
    }

    /* Blob 1: Lima (Tu color primario) */
    .blob-1 {
        top: -10%;
        right: -10%;
        width: 60vw;
        height: 60vw;
        background: #a3e635; 
        animation-duration: 30s;
    }

    /* Blob 2: El violeta/azul de tu config */
    .blob-2 {
        bottom: -15%;
        left: -5%;
        width: 50vw;
        height: 50vw;
        background: #6366f1; /* Indigo-500 para balancear con el violeta */
        animation-delay: -7s;
        animation-duration: 25s;
    }

    /* Blob 3: Zinc oscuro para profundidad */
    .blob-3 {
        top: 40%;
        left: 30%;
        width: 35vw;
        height: 35vw;
        background: #27272a; 
        opacity: 0.15;
        animation-duration: 40s;
    }

    @keyframes float {
        0% { 
            transform: translate(0, 0) scale(1) rotate(0deg); 
        }
        33% { 
            transform: translate(8%, 12%) scale(1.1) rotate(10deg); 
        }
        66% { 
            transform: translate(-5%, 8%) scale(0.9) rotate(-10deg); 
        }
        100% { 
            transform: translate(0, 0) scale(1) rotate(0deg); 
        }
    }

    /* Mobile adjustments: Remove completely for performance */
    @media (max-width: 768px) {
        .grainy-container {
            display: none !important;
        }
    }
</style>