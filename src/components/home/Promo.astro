---
// src/components/sections/home/Promo.astro
type Promo = {
  enabled: boolean;
  badge?: string;
  title: string;
  location?: string;
  description?: string;
  imageUrl?: string;
  imageAlt?: string;
  ctaLabel: string;
  ctaHref: string;
  whatsappNumber?: string;
  whatsappLabel?: string;
  accent?: "violet" | "cyan" | "blue";
};

const promo = (Astro.props?.promo ?? null) as Promo | null;
if (!promo || !promo.enabled) return null;

const {
  badge = "DESTACADO",
  title,
  location = "",
  description = "",
  imageUrl = "",
  imageAlt = title,
  ctaLabel,
  ctaHref,
  accent = "violet",
} = promo;

// Mapeo de colores para bordes y acentos
const accentColors = {
  violet: "border-purple-500/30 text-purple-400",
  cyan: "border-cyan-500/30 text-cyan-400",
  blue: "border-blue-500/30 text-blue-400",
};

const accentClass = accentColors[accent] || accentColors.violet;
---

<section 
  class="relative z-20 w-full overflow-hidden border-y transition-colors duration-300
    bg-black border-white/10 
    data-[theme=light]:bg-gray-50 data-[theme=light]:border-gray-200"
  aria-label="Destacado"
>
  
  <div class={`absolute inset-0 opacity-20 pointer-events-none bg-gradient-to-r ${accent === 'violet' ? 'from-purple-900/40' : 'from-cyan-900/40'} to-transparent`}></div>

  <div class="mx-auto max-w-6xl px-6 py-12 md:py-16 relative z-10">
    <div class="flex flex-col md:flex-row items-center gap-8 md:gap-12">
      
      {imageUrl && (
        <div class="shrink-0 w-full md:w-1/3 max-w-sm">
          <div class="aspect-video md:aspect-[4/3] rounded-2xl overflow-hidden shadow-2xl border border-white/10 relative group">
            <img 
              src={imageUrl} 
              alt={imageAlt} 
              loading="lazy" 
              class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
            />
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-60"></div>
          </div>
        </div>
      )}

      <div class="flex-1 text-center md:text-left">
        
        <div class="flex flex-wrap items-center justify-center md:justify-start gap-4 mb-4">
          <span class={`px-3 py-1 rounded-full text-[10px] font-bold tracking-widest uppercase border bg-white/5 backdrop-blur-md ${accentClass}`}>
            {badge}
          </span>
          {location && (
            <span class="flex items-center gap-1.5 text-xs font-medium text-gray-400 uppercase tracking-wide">
              <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
              {location}
            </span>
          )}
        </div>

        <h2 class="text-3xl md:text-4xl lg:text-5xl font-black text-white mb-4 leading-tight tracking-tight
                   data-[theme=light]:text-gray-900 transition-colors">
          {title}
        </h2>

        {description && (
          <p class="text-gray-400 text-base md:text-lg leading-relaxed mb-8 max-w-2xl
                    data-[theme=light]:text-gray-600 transition-colors">
            {description}
          </p>
        )}

        <div class="flex flex-wrap items-center justify-center md:justify-start gap-4">
          <a 
            href={ctaHref} 
            class="px-8 py-3 bg-white text-black font-bold rounded-full hover:scale-105 transition-transform shadow-[0_0_20px_rgba(255,255,255,0.2)]
                   data-[theme=light]:bg-black data-[theme=light]:text-white data-[theme=light]:shadow-xl"
          >
            {ctaLabel}
          </a>
          
          <a href="#" class="text-sm font-medium text-gray-400 hover:text-white transition-colors flex items-center gap-2 group/link data-[theme=light]:text-gray-600 data-[theme=light]:hover:text-black">
            Consultar por WhatsApp 
            <span class="group-hover/link:translate-x-1 transition-transform">→</span>
          </a>
        </div>

      </div>
    </div>
  </div>
</section>

<style>
  /* Fallback por si Tailwind no pilla el data-theme directamente */
  :global(:root[data-theme="light"]) section {
    background-color: #F9FAFB; /* Gray 50 */
    border-color: #E5E7EB; /* Gray 200 */
  }
  :global(:root[data-theme="light"]) h2 {
    color: #111827;
  }
  :global(:root[data-theme="light"]) p {
    color: #4B5563;
  }
  :global(:root[data-theme="light"]) a.bg-white {
    background-color: #000;
    color: #fff;
  }
</style>