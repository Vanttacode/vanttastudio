---
const { class: className } = Astro.props;

const faqs = [
    { 
        question: "¿Qué tipos de sitios web desarrollan?", 
        answer: "Nos especializamos en sitios web de alto rendimiento utilizando <strong>Astro, React y Vue</strong>. Desde landing pages optimizadas para conversión hasta plataformas corporativas complejas y e-commerce." 
    },
    { 
        question: "¿Cómo ayudan a mejorar las ventas de mi negocio?", 
        answer: "Combinamos diseño estratégico con optimización de conversión (CRO). No solo creamos sitios bonitos, sino herramientas de venta diseñadas para guiar al usuario hacia la acción." 
    },
    { 
        question: "¿El desarrollo incluye optimización SEO?", 
        answer: "Sí, todos nuestros desarrollos nacen con una arquitectura <strong>SEO-friendly</strong>. Optimizamos la velocidad de carga, etiquetas meta y estructura de datos para que Google te encuentre fácilmente." 
    },
    { 
        question: "¿Ofrecen mantenimiento después del lanzamiento?", 
        answer: "Totalmente. Ofrecemos planes de soporte y actualización para asegurar que tu plataforma siga siendo segura, rápida y funcional a medida que tu negocio crece." 
    },
    { 
        question: "¿Pueden integrar sistemas de terceros (CRM/ERP)?", 
        answer: "Sí, somos expertos en conectar tu sitio web con tus herramientas de gestión favoritas como <strong>HubSpot, Salesforce, SAP</strong> o soluciones a medida vía API." 
    },
    { 
        question: "¿Cuánto tiempo toma desarrollar un proyecto?", 
        answer: "Depende de la complejidad, pero una landing page estratégica suele tomar entre <strong>2 y 3 semanas</strong>, mientras que una plataforma a medida puede llevar de <strong>6 a 12 semanas</strong>." 
    },
];
---

<section id="faq" class:list={["relative bg-zinc-950 text-white overflow-hidden", className]}>
    <div class="max-w-7xl mx-auto px-6 md:px-12 py-32 flex flex-col lg:flex-row gap-16">
        
        <div class="lg:w-1/3 lg:sticky lg:top-32 lg:h-fit">
            <h2 class="font-display text-7xl md:text-8xl lg:text-9xl font-black tracking-tighter italic leading-none">
                FAQ
            </h2>
            <div class="h-1 w-20 bg-lime-400 mt-6 mb-4"></div>
            <p class="text-zinc-500 font-mono text-sm uppercase tracking-[0.3em]">
                Resolviendo dudas
            </p>
        </div>
        
        <div class="lg:w-2/3 flex flex-col gap-4">
            {
                faqs.map(({ question, answer }) => (
                    <div class="faq-item group border border-zinc-900 bg-zinc-900/30 rounded-3xl overflow-hidden transition-colors hover:border-zinc-700">
                        <button class="faq-trigger flex w-full justify-between items-center gap-6 px-8 py-10 cursor-pointer text-left">
                            <span class="text-xl md:text-2xl font-bold tracking-tight text-zinc-300 group-hover:text-white transition-colors uppercase italic">
                                {question}
                            </span>
                            <div class="relative flex items-center justify-center w-10 h-10 rounded-full border border-zinc-800 bg-zinc-950 group-hover:border-lime-400 transition-all">
                                <span class="faq-icon-line absolute w-4 h-0.5 bg-lime-400"></span>
                                <span class="faq-icon-line absolute w-4 h-0.5 bg-lime-400 rotate-90"></span>
                            </div>
                        </button>
                        
                        <div class="faq-content h-0 overflow-hidden">
                            <div class="px-8 pb-10 text-zinc-400 leading-relaxed text-lg font-medium max-w-2xl">
                                <p set:html={answer} />
                            </div>
                        </div>
                    </div>
                ))
            }
        </div>
    </div>
</section>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    function initFaq() {
        const items = document.querySelectorAll('.faq-item');

        items.forEach(item => {
            const trigger = item.querySelector('.faq-trigger');
            const content = item.querySelector('.faq-content');
            const iconVerticalLine = item.querySelectorAll('.faq-icon-line')[1];
            
            let isOpen = false;

            trigger.addEventListener('click', () => {
                isOpen = !isOpen;

                // Animación del contenido
                gsap.to(content, {
                    height: isOpen ? "auto" : 0,
                    duration: 0.5,
                    ease: "expo.inOut"
                });

                // Animación del icono (convertir el + en -)
                gsap.to(iconVerticalLine, {
                    rotate: isOpen ? 0 : 90,
                    opacity: isOpen ? 0 : 1,
                    duration: 0.4,
                    ease: "power2.inOut"
                });

                // Highlight del borde
                gsap.to(item, {
                    borderColor: isOpen ? "#a3e635" : "rgba(39, 39, 42, 1)",
                    backgroundColor: isOpen ? "rgba(24, 24, 27, 0.8)" : "rgba(24, 24, 27, 0.3)",
                    duration: 0.4
                });
            });
        });

        // Revelado inicial de los items al hacer scroll
        gsap.from(".faq-item", {
            y: 50,
            opacity: 0,
            duration: 0.8,
            stagger: 0.1,
            ease: "power3.out",
            scrollTrigger: {
                trigger: "#faq",
                start: "top 80%",
            }
        });
    }

    document.addEventListener("astro:page-load", initFaq);
    initFaq();
</script>

<style>
    .faq-trigger {
        -webkit-tap-highlight-color: transparent;
    }
    
    /* Para que el texto de las respuestas no se vea "aplastado" durante la animación */
    .faq-content p {
        text-wrap: balance;
    }
</style>