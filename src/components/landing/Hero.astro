---
const { class: className } = Astro.props;

// Textos fijos en español para eliminar la dependencia de i18n
const dynamicWords = ["WEBS", "SOFTWARE", "MARCAS", "SISTEMAS"];

const heroTitleMain = "Creamos";
const heroSubtitle = "Arquitectura digital de alto rendimiento. Diseñamos sistemas y plataformas creadas para escalar la operativa e impacto de tu negocio.";
const contactText = "Contacto";
---

<section id="hero" class:list={["relative min-h-[110vh] overflow-hidden bg-zinc-950 text-white selection:bg-lime-400 selection:text-black flex items-center justify-center pt-32 pb-40", className]}>
    
    <div id="hero-light-wrapper" class="pointer-events-none absolute inset-0 z-10 overflow-hidden">
        <div id="mouse-follower-light" class="absolute h-[600px] w-[600px] -translate-x-1/2 -translate-y-1/2 rounded-full bg-lime-400/15 blur-[130px] opacity-0"></div>
    </div>

    <div class="container mx-auto flex flex-col items-center justify-center px-4 text-center relative z-20">
        
        <h1 class="hero-title pt-16 font-display font-black uppercase text-[13vw] sm:text-[12vw] lg:text-[11rem] w-full leading-[0.8] tracking-[0.05em]">
            <span class="block mb-4 overflow-hidden">
                <span class="inline-block translate-y-full hero-main-title">{heroTitleMain}</span>
            </span>
            
            <div class="relative flex justify-center text-lime-400 italic">
                <div class="word-wrapper relative h-[1.1em] w-full flex items-center justify-center overflow-hidden">
                    {dynamicWords.map((word) => (
                        <span class="word-item absolute whitespace-nowrap opacity-0">{word}</span>
                    ))}
                </div>
            </div>
        </h1>

        <div class="hero-content mt-24 flex max-w-3xl flex-col items-center gap-10 opacity-0">
            <p class="font-mono text-sm leading-relaxed text-zinc-400 md:text-lg px-4 uppercase tracking-[0.2em] max-w-3xl">
                {heroSubtitle}
            </p>
            
            <div class="flex flex-col items-center gap-16">
                <a
                    href="/contact"
                    class="group relative flex h-16 min-w-[280px] items-center justify-center overflow-hidden rounded-full border border-white/10 bg-white px-10 py-4 font-bold uppercase tracking-[0.2em] text-black transition-all hover:bg-lime-400 hover:border-lime-400 active:scale-95"
                >
                    <span class="relative z-10">{contactText}</span>
                </a>

                <div class="group/brand flex flex-col items-center gap-4 cursor-default">
                    <span class="text-[10px] font-bold uppercase tracking-[0.6em] text-zinc-500 group-hover/brand:text-lime-400 transition-colors duration-500">
                        VANTTA STUDIO
                    </span>
                    <div class="relative h-20 w-px bg-zinc-800 overflow-hidden">
                        <div class="scroll-line absolute top-0 left-0 w-full h-full bg-lime-400"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="pointer-events-none absolute inset-0 z-0">
        <div class="absolute right-[-5%] top-[10%] h-[400px] w-[400px] rounded-full bg-violet-600/5 blur-[120px]"></div>
        <div class="absolute bottom-0 left-0 w-full h-80 bg-gradient-to-t from-zinc-950 via-zinc-950 to-transparent"></div>
    </div>
</section>

<style>
    .hero-title {
        perspective: 1200px;
        letter-spacing: 0.05em;
    }

    .word-item {
        will-change: transform, opacity;
        transform-style: preserve-3d;
    }

    @keyframes linePulse {
        0% { transform: translateY(-100%); }
        50% { transform: translateY(0%); }
        100% { transform: translateY(100%); }
    }

    .scroll-line {
        animation: linePulse 4s infinite cubic-bezier(0.4, 0, 0.2, 1);
    }

    .group\/brand:hover .scroll-line {
        animation-duration: 1.5s;
    }

    #hero {
        backface-visibility: hidden;
        transform: translateZ(0);
    }
</style>

<script>
    import { gsap } from "gsap";

    let mouseMoveHandler = null;

    function initHero() {
        gsap.killTweensOf("*");
        if (mouseMoveHandler) {
            window.removeEventListener("mousemove", mouseMoveHandler);
        }

        const titleLine = document.querySelector(".hero-main-title");
        const content = document.querySelector(".hero-content");
        const words = document.querySelectorAll(".word-item");
        const mouseLight = document.getElementById("mouse-follower-light");

        if (!titleLine || !content || !mouseLight) return;

        gsap.set(titleLine, { y: "100%" });
        gsap.set(content, { opacity: 0, y: 20 });
        gsap.set(mouseLight, { opacity: 0 });

        const tl = gsap.timeline({ defaults: { ease: "expo.out" } });

        tl.to(titleLine, {
            y: 0,
            duration: 1.5,
            delay: 0.2
        })
        .to(content, {
            opacity: 1,
            y: 0,
            duration: 1
        }, "-=0.8")
        .to(mouseLight, { 
            opacity: 1, 
            duration: 1.5 
        }, "-=0.5");

        mouseMoveHandler = (e) => {
            gsap.to(mouseLight, {
                x: e.clientX,
                y: e.clientY,
                duration: 0.8,
                ease: "power2.out"
            });
        };
        window.addEventListener("mousemove", mouseMoveHandler);

        let currentIndex = 0;
        let wordRotationActive = true;

        const rotateWords = () => {
            if (!wordRotationActive || !words.length) return;

            const currentWord = words[currentIndex];
            const nextIndex = (currentIndex + 1) % words.length;
            const nextWord = words[nextIndex];

            gsap.timeline()
                .to(currentWord, { y: -50, opacity: 0, rotateX: 90, duration: 0.6, ease: "power4.in" })
                .fromTo(nextWord, 
                    { y: 50, opacity: 0, rotateX: -90 },
                    { y: 0, opacity: 1, rotateX: 0, duration: 0.7, ease: "power4.out" },
                    "-=0.2"
                );

            currentIndex = nextIndex;
            gsap.delayedCall(2.5, rotateWords);
        };

        if(words.length > 0) {
            gsap.set(words, { opacity: 0, y: 50 });
            gsap.set(words[0], { opacity: 1, y: 0 });
            gsap.delayedCall(3, rotateWords);
        }

        document.addEventListener("astro:before-preparation", () => {
            wordRotationActive = false;
            if (mouseMoveHandler) window.removeEventListener("mousemove", mouseMoveHandler);
            gsap.killTweensOf("*");
        }, { once: true });
    }

    document.addEventListener("astro:page-load", initHero);
    
    if (document.readyState !== "loading") {
        initHero();
    }
</script>